<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Javascript HW</title>
</head>
<body>
<h1>Javascript Home Work 4</h1>
<script>

    //Обязательное условие для всех функций, которые требуется реализовать: предусмотреть механизм под названием
    // "защита от дурака" - суть механизма заключается в том, что вы должны проверять поступающие на вход параметры:
    // соответствуют ли информация из параметров требованиям, которые применяются в условии к задачи. Если данные в
    // параметрах не удовлетворяют требованиям - выводить сообщение об ошибке в консоль и прекращать работу функции
    // (возвращать null)

    //1) Дан массив длинною 15 элементов, значения для элементов массива подобрать произвольным образом в интервале
    // от -100 до 100. Создать функцию, которая принимает в качестве параметра обозначенный выше массив и возвращает объект вида:
    //{totalPlus: NNN, totalMinus: MMM, totalZero: ZZZ}
    // где NNN - это количество всех положительных чисел, MMM - количество всех отрицательных чисел,
    // ZZZ - количество элементов равных нулю

    var arr1 = [];
    //var arr1 = [2,'w',3,'s',1,'f','x','t','a','s','d','f','s','x','w']; //для проверки "защита от дурака"

    var randomVal = (min, max) => Math.floor(min + Math.random() * (max + 1 - min));

    for (var i = 0; i < 15; i++) {
    arr1.push(randomVal(-100, 100))}

    console.log("Значение arr1 ->", arr1);

    function checkArrNumber(arrIn) {
        var checkArr = true;
        arrIn.forEach(function (item) {
            if (typeof (item) !== "number"){
                checkArr = false;
            }
        });
        return checkArr;
    }

    console.log("Задание 1")

    function funUnit1(arrIn) {
        var objRes = {
            totalPlus: 0,
            totalMinus: 0,
            totalZero: 0,
        };
        var checkArray = true;
        arrIn.forEach(function (item) {
            if ((item < -100) || (item > 100) || typeof(item) !== "number") {
                checkArray = false;
            }
        });
        if (Array.isArray(arrIn) && (arrIn.length === 15) && checkArray){
            arrIn.forEach(function (item) {
                if (item < 0) {
                    objRes.totalMinus++
                } else {
                    if (item > 0) {
                        objRes.totalPlus++
                    } else {
                        objRes.totalZero++
                    }
                }
            });
            return objRes;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null;
        }
    }

    console.log("Результат работы funUnit1 ->", funUnit1(arr1));

    console.log("Задание 1 через прототипное наследование -------------------");

    Array.prototype.funUnit1 = function () {
        var objRes = {
            totalPlus: 0,
            totalMinus: 0,
            totalZero: 0,
        };
        var checkArray = true;
        this.forEach(function (item) {
            if ((item < -100) || (item > 100) || typeof(item) !== "number") {
                checkArray = false;
            }
        });
        if (Array.isArray(this) && (this.length === 15) && checkArray){
            this.forEach(function (item) {
                if (item < 0) {
                    objRes.totalMinus++
                } else {
                    if (item > 0) {
                        objRes.totalPlus++
                    } else {
                        objRes.totalZero++
                    }
                }
            });
            return objRes;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null;
        }
    }

    console.log("Результат работы funUnit1 через прототипное наследование ->", arr1.funUnit1());

    //5) Дана строка содержащая произвольной длинны число в виде текста. Создать функцию, которая принимает на
    // вход первым параметром переменную с текстом, вторым параметром переменную-флаг (может быть равной "AZ" либо "ZA").
    // Функция должна отсортировать цифры из переменной с "текстом-числом" в зависимости от переменной-флага:
    // AZ - сортировка по возрастанию, ZA - сортировка по убыванию. Обеспечить правильную работу функции вне
    // зависимости от того, в каком виде пришло значение переменной-флага (должна одинаково успешно отрабатывать
    // варианты Az, az, aZ и пр). Функция должна вернуть результат - отсортированное число-строку

    console.log("Задание 5");

    var str2 = "19724684649863437262651323129872837";

    var flag1 = prompt("Введите FLAG для Задания 4 в виде AZ или ZA", "AZ");

    flag1 = flag1.toLowerCase();

    function funUnit5(strIn, flagIn) {
        var res = "";
        if (((flagIn.codePointAt(0) === 97) || (flagIn.codePointAt(0) === 122)) && !isNaN(+strIn) && (flagIn.length === 2)) {
            if (flagIn.codePointAt(0) === 97) {
                res = strIn.split('');
                res.sort();
                return res.join('')
            } else {
                res = strIn.split('');
                res.sort();
                res.reverse();
                return res.join('')
            }
        } else {
            console.log("Введен не верный FLAG или строка")
            return null;
        }

    }
    console.log("Дана строка ->", str2);
    console.log("Результат работы funUnit5 ->", funUnit5(str2, flag1));

    console.log("Задание 5 через прототипное наследование -------------------");

    String.prototype.funUnit5 = function (flagIn) {
        var res = "";
        if (((flagIn.codePointAt(0) === 97) || (flagIn.codePointAt(0) === 122)) && !isNaN(+this) && (flagIn.length === 2)) {
            if (flagIn.codePointAt(0) === 97) {
                res = this.split('');
                res.sort();
                return res.join('')
            } else {
                res = this.split('');
                res.sort();
                res.reverse();
                return res.join('')
            }
        } else {
            console.log("Введен не верный FLAG или строка")
            return null;
        }

    }

    console.log("Результат работы funUnit5 через прототипное наследование ->", str2.funUnit5(flag1));

    //7) Дано произвольное число разрядностью больше 5 (тип данных number). Необходимо сделать функцию, которая
    // считает сумму определенных цифр числа, полученного на вход, а именно  цифры 1я, 2я и последняя и предпоследняя.
    // Функция должна вернуть число -  результат работы.

    console.log("Задание 7");

    var num = 123087875637;

    function funUnit7 (numIn) {
        if (typeof (numIn) === "number"){
            var str = String (numIn);
            console.log(str);
            var res = 0;
            for (var i = 1; i <= 2; i++) {
                res = res+(+str[i-1])+(+str[str.length-i]);
            }
            return res;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Дано число ->", num);
    console.log("Результат работы funUnit7 ->", funUnit7(num));

    console.log("Задание 7 через прототипное наследование -------------------");

    Number.prototype.funUnit7 = function () {
        console.log(typeof this) //Почему Object?
        if (typeof (+this) === "number"){ //(+this) исправляем прилетевший Object
            var str = String (this);
            console.log(str);
            var res = 0;
            for (var i = 1; i <= 2; i++) {
                res = res+(+str[i-1])+(+str[str.length-i]);
            }
            return res;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Результат работы funUnit7 через прототипное наследование ->", num.funUnit7());

    //8) Дана строка произвольного текста. Сделать функцию, которая принимает на вход строку текста и удаляет из
    // нее все символы, которые повторяются 2 и более раза друг за другом. Вернуть из функции результат в виде новой строки.

    console.log("Задание 8");

    var str5 = "123mmohs(((****gnnnb777sfkjjjj000lkjshhhfgb";

    function funUnit8 (strIn) {
        if (typeof (strIn) === "string") {
            var countDel = 0; //счетчик удаления
            var countArr = 0; //счетчик состояния нового массива
            var arr = strIn.split('');
            for (var i = 0; i < strIn.length; i++){
                if (arr[countArr] === arr[countArr+1]) {
                    arr.splice(countArr+1, 1);
                    countDel++;
                } else { if (countDel > 0){
                    arr.splice(countArr, 1);
                    countDel = 0;
                } else {
                    countArr++;
                }
                }
            }
            return arr.join('');
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Дана строка ->", str5);
    console.log("Результат работы funUnit8 ->", funUnit8(str5));

    console.log("Задание 8 через прототипное наследование -------------------");

    String.prototype.funUnit8 = function () {
        console.log(typeof this); //Почему Object?
        console.log(this);
        var tempStr = JSON.stringify(this);
        console.log("Результат JSON ->", tempStr);
        if (typeof (tempStr) === "string") {
            var countDel = 0; //счетчик удаления
            var countArr = 0; //счетчик состояния нового массива
            var arr = tempStr.split('');
            for (var i = 0; i < tempStr.length; i++){
                if (arr[countArr] === arr[countArr+1]) {
                    arr.splice(countArr+1, 1);
                    countDel++;
                } else { if (countDel > 0){
                    arr.splice(countArr, 1);
                    countDel = 0;
                } else {
                    countArr++;
                }
                }
            }
            return arr.join('');
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Результат работы funUnit8 через прототипное наследование ->", str5.funUnit8());

    //10) Дан массив чисел произвольной длинны. Сделать функцию, которая удаляет из исходного массива повторяющиеся
    // цифры в числе (новый массив НЕ делать). Функция должна возвращать результат в виде true/false: true - если
    // был удален, хотя бы 1 элемент, false - если не нашлось что удалить.

    console.log("Задание 10");

    var arr2 = [2, 34, 55, 12, -115598, 33, -45, 3239900645, 8722, -11233566]
    var arr3 = arr2.concat();

    function funUnit10 (arrIn) {
        if (checkArrNumber(arrIn)){
            var countDel = 0;
            arrIn.forEach(function (item, index) {
                var str = funUnit8(String(item));
                if (String(item) !== str) {
                    if (((+str) === 0) || (isNaN(+str))) {
                        arrIn.splice(index, 1);
                        countDel++;

                    } else {
                        arrIn.splice(index, 1, (+str));
                        countDel++;
                    }
                }
            });
            console.log("Результирующий массив ->", arrIn);
            return countDel !== 0;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Дан массив ->", arr2);
    console.log("Результат работы funUnit10 ->", funUnit10(arr2));

    console.log("Задание 10 через прототипное наследование -------------------");

    Array.prototype.funUnit10 = function () {
        if (checkArrNumber(this)){
            let countDel = 0;
            let arrIn = this
            this.forEach(function (item, index) {
                let str = funUnit8(String(item));
                if (String(item) !== str) {
                    if (((+str) === 0) || (isNaN(+str))) {
                        arrIn.splice(index, 1);
                        countDel++;
                    } else {
                        arrIn.splice(index, 1, (+str));
                        countDel++;
                    }
                }
            });
            console.log("Результирующий массив ->", arrIn);
            return countDel !== 0;
        } else {
            console.log("ОШИБКА! Данные не удовлетворяют требованиям");
            return null
        }

    }

    console.log("Результат работы funUnit10 через прототипное наследование ->", arr3.funUnit10());

    //Из предыдущего задания взять задачи под номерами 1, 5, 7, 8 и 10. Необходимо сделать реализацию этих
    // функций через прототипное наследование, таким образом чтобы обозначенная в задаче функциональность была
    // доступна в качестве встроенного метода для типа данных или массива, над которым производятся манипуляции в задаче.
    //Например если в условии задачи написано, что она принимает на вход строку, с которой потом работает,
    // тогда вам нужно сделать встроенный в String метод, который будет работать с исходной строкой (аналогично тому,
    // как делали с преподапателем) и внутри этого метода обращаться к строке через this. Такие же требования для
    // остальных задач, с разницей в типе функции обертке - Number,  Array.

    //Дополнительные задачи:

    //6) Напишите функцию, доступную в качестве метода для любого массива, которая обрабатывает массив объектов.
    // На вход функция должна принять переменную "имя поля". Далее обработать исходный массив и вернуть новый массив
    // со значениями из всех объектов. Значения в каждом объекте взять из поля с названием, переданным в переменной
    // в качестве параметра функции.

    //7) Напишите функцию, доступную в качестве метода для любого массива, которая принимает на вход 1 параметр -
    // это число. Функция обрабатывает исходный массив и возвращает true/false - это результат проверки всех элементов
    // массива на кратность числу, полученному в качестве параметра функции.

    //8) Напишите функцию searchStr, доступную в качестве метода для любой строки, которая ищет в исходной
    // строке подстроку - переменную полученную на вход в качестве параметра. Функция возвращает число -
    // количество вхождений подстроки в строку.

    //9) Напишите функцию insertStrTo, доступную в качестве метода для любой строки. Функция получает на вход 2
    // параметра: 1й - позиция, 2й - подстрока. Функция должна вставить подстроку в исходную строку. Строка
    // вставляется в позицию индекса равного значению переменной, которая была передана функции в качестве
    // первого параметра. Если в позиции передается значение меньше нуля - вставка происходит в позицию с
    // индексом ноль. Если в позиции передается значение больше длины строки - вставка происходит в позицию с
    // индексом length-1 т.е. в конец строки. Функция должа менять исходную строку, а не возвращать результат в
    // виде новой строки.

    //Обратите внимание на термины "исходная строка", "исходный массив" - под этими терминами подразумевается
    // строка или массив на который будет указывать this внутри разрабатываемой функции, когда ее будут выполнять.

</script>
</body>
</html>